<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì•„ì´ë”” ì°¾ê¸°</title>
    <link rel="stylesheet" href="/css/Sign/find_id.css">
</head>
<body>
    <!-- í—¤ë” -->
    <div th:replace="~{header :: header}"></div>

    <!-- ì•„ì´ë”” ì°¾ê¸° ë³¸ë¬¸ -->	
	<main class="find-container">
	    <h1>ì•„ì´ë”” ì°¾ê¸°</h1>
	    
	    <!-- ì•„ì´ë”” ì°¾ê¸° í¼ -->
	    <div id="find-form">
	        <div class="form-row">
	            <label for="member-type">íšŒì›ìœ í˜•</label>
	            <select id="member-type" name="memberType" required>
	                <option value="personal">ê°œì¸íšŒì›</option>
	                <option value="personal-business">ê°œì¸ ì‚¬ì—…ìíšŒì›</option>
	            </select>
	        </div>
	
	        <div class="form-row">
	            <label>ì°¾ê¸° ë°©ë²•</label>
	            <div class="radio-group">
	                <input type="radio" id="email" name="findMethod" value="email" onclick="toggleFields('email')" checked>
	                <label for="email">ì´ë©”ì¼</label>
	                <input type="radio" id="phone" name="findMethod" value="phone" onclick="toggleFields('phone')">
	                <label for="phone">íœ´ëŒ€í°ë²ˆí˜¸</label>
	            </div>
	        </div>
	
	        <div class="form-row">
	            <label for="name">ì´ë¦„</label>
	            <input type="text" id="name" name="name" placeholder="ì´ë¦„" required>
	        </div>
	
	        <div class="form-row email-fields">
	            <label for="email-input">ì´ë©”ì¼</label>
	            <input type="email" id="email-input" name="email" placeholder="example@email.com" required>
	        </div>
	
	        <div class="form-row phone-fields" style="display: none;">
	            <label for="phone-input">íœ´ëŒ€í° ë²ˆí˜¸</label>
	            <input type="text" id="phone-input" name="phone" placeholder="01012345678" maxlength="11" required>
	        </div>
	
	        <button type="button" class="find-btn" onclick="findId()">í™•ì¸</button>
	    </div>
	
		<!-- ê²°ê³¼ ì¶œë ¥ (ì´ˆê¸°ì—ëŠ” ìˆ¨ê¹€) -->
		<div id="find-result" style="display: none; text-align: center; margin-top: 20px;">
		    <div id="result-message" class="result-message"></div>
		    <button type="button" class="retry-btn" onclick="resetForm()">ë‹¤ì‹œ ì°¾ê¸°</button>
		</div>

	</main>


    <!-- í‘¸í„° -->
    <div th:replace="~{footer :: footer}"></div>
    
    <script>
        function toggleFields(method) {
            const emailFields = document.querySelector(".email-fields");
            const phoneFields = document.querySelector(".phone-fields");

            if (method === "email") {
                emailFields.style.display = "flex";
                phoneFields.style.display = "none";
            } else {
                emailFields.style.display = "none";
                phoneFields.style.display = "flex";
            }
        }
    </script>
    
	<script>
	function findId() {
	    const findMethod = document.querySelector('input[name="findMethod"]:checked').value;
	    const name = document.getElementById('name').value;
	    let contact = "";
	
	    if (findMethod === "email") {
	        contact = document.getElementById('email-input').value;
	    } else {
	        contact = document.getElementById('phone-input').value;
	    }
	
	    console.log("ğŸ”¹ ìš”ì²­ ë³´ë‚´ëŠ” ì¤‘...", { name, contact, findMethod });
	
	    fetch("/find_id", {
	        method: "POST",
	        headers: { "Content-Type": "application/x-www-form-urlencoded" },
	        body: new URLSearchParams({ name: name, contact: contact, findMethod: findMethod })
	    })
	    .then(response => response.json())
	    .then(data => {
	        console.log("ğŸ”¹ ì„œë²„ ì‘ë‹µ:", data);
	
	        // í¼ ìˆ¨ê¸°ê³  ê²°ê³¼ ì˜ì—­ í‘œì‹œ
	        document.getElementById("find-form").style.display = "none";
	        document.getElementById("find-result").style.display = "flex"; // ğŸ”¹ flexë¡œ ë³€ê²½
	        document.getElementById("find-result").style.flexDirection = "column";
	        document.getElementById("find-result").style.justifyContent = "center";
	        document.getElementById("find-result").style.alignItems = "center";
	
	        // ê²°ê³¼ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
	        const resultMessage = document.getElementById("result-message");
	        resultMessage.style.color = data.success ? "green" : "red";
	        resultMessage.innerHTML = data.success
	            ? `<strong>ì•„ì´ë””:</strong> ${data.username}`
	            : "ì¼ì¹˜í•˜ëŠ” íšŒì› ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.";
	    })
	    .catch(error => console.error("âŒ AJAX ìš”ì²­ ì˜¤ë¥˜:", error));
	}
	
	// ë‹¤ì‹œ ì°¾ê¸° ê¸°ëŠ¥
	function resetForm() {
	    document.getElementById("find-form").style.display = "block";
	    document.getElementById("find-result").style.display = "none";
	}
	</script>



    
</body>
</html>
